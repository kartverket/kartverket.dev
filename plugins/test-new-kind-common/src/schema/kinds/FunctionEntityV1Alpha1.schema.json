{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "FunctionEntityV1alpha1",
  "description": "A Database describes a database instance in your infrastructure",
  "examples": [
    {
      "apiVersion": "mycompany.net/v1alpha1",
      "kind": "Function",
      "metadata": {
        "name": "user-service-db",
        "description": "PostgreSQL database for the user service",
        "labels": {
          "environment": "production"
        },
        "annotations": {
          "mycompany.net/backup-schedule": "daily"
        }
      },
      "spec": {
        "type": "Viktigfunksjon",
        "lifecycle": "production",
        "owner": "platform-team",
        "system": "user-management",
        "endpoint": "user-db.prod.mycompany.net:5432",
        "provider": "aws",
        "region": "us-east-1"
      }
    }
  ],
  "allOf": [
    {
      "$ref": "Entity"
    },
    {
      "type": "object",
      "required": ["apiVersion", "kind", "spec"],
      "properties": {
        "apiVersion": {
          "enum": ["mycompany.net/v1alpha1"]
        },
        "kind": {
          "enum": ["Function"]
        },
        "spec": {
          "type": "object",
          "required": ["type", "lifecycle", "owner"],
          "properties": {
            "type": {
              "type": "string",
              "description": "The type of database",
              "minLength": 1,
              "examples": ["Viktigfunksjon"]
            },
            "lifecycle": {
              "type": "string",
              "description": "The lifecycle stage of the database",
              "minLength": 1,
              "examples": ["experimental", "production", "deprecated"]
            },
            "owner": {
              "type": "string",
              "description": "An entity reference to the owner of the database",
              "minLength": 1,
              "examples": ["platform-team", "data-team"]
            },
            "system": {
              "type": "string",
              "description": "An entity reference to the system this database belongs to",
              "minLength": 1
            },
            "endpoint": {
              "type": "string",
              "description": "Connection endpoint (without credentials)",
              "minLength": 1
            },
            "provider": {
              "type": "string",
              "enum": ["aws", "gcp", "azure", "on-premise"],
              "description": "Cloud provider where this database is hosted"
            },
            "region": {
              "type": "string",
              "description": "Region where the database is deployed",
              "minLength": 1
            }
          }
        }
      }
    }
  ]
}
