import { Link } from '@backstage/core-components';
import { VulnerabilityIdInfo } from '../../../typesFrontend';

export interface IdsWithURLsProps {
  vulnerabilityIdInfo: VulnerabilityIdInfo[];
}

export const IdsWithUrls = ({ vulnerabilityIdInfo }: IdsWithURLsProps) => {
  const idInfoWithUrl = vulnerabilityIdInfo.filter(
    id => id.url !== undefined && id.url !== null,
  );

  if (idInfoWithUrl.length === 0) {
    return (
      <>
        <strong>ID(s): </strong>
        {vulnerabilityIdInfo.map(vulnerability => vulnerability.id).join(', ')}
      </>
    );
  }
  return (
    <>
      <strong>Link(s): </strong>
      {idInfoWithUrl.map(id => (
        <>
          {idInfoWithUrl.length > 1 && <br />}
          <Link to={id.url!}>{id.id}</Link>
        </>
      ))}
    </>
  );
};
