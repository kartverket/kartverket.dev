import Typography from "@mui/material/Typography"

import { Vulnerability } from "../../../typesFrontend"
import { Link } from "@backstage/core-components"
import { getCveURL } from "../../utils"
import { ErrorBanner } from "../../ErrorBanner"

interface PharosContentProps {
    vulnerability: Vulnerability
}

export const PharosContent = ({ vulnerability }: PharosContentProps) => {
    const info = vulnerability.scannerSpecificInfo.pharosInfo
    if (!info) {
        return <ErrorBanner />
    }
    const link = new URL(info?.htmlUrl).href

    return (
        <Typography>
            <strong>CVE-link: </strong>
            <Link to={getCveURL(vulnerability.vulnerabilityId)}>
                {vulnerability.vulnerabilityId}
            </Link>
            <br />
            <strong>Pharos-link: </strong>
            <Link to={link}>
                {link.length > 80 ? link.slice(0, 30).concat("...") : link}
            </Link>
            <br />
            <strong>Branch: </strong>
            {info.branch}
        </Typography>
    )
}
