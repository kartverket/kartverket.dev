import Typography from '@mui/material/Typography';

import { Vulnerability } from '../../../typesFrontend';
import { Link } from '@backstage/core-components';
import { getCveURL } from '../../utils';
import { ErrorBanner } from '../../ErrorBanner';

interface SysdigContentProps {
  vulnerability: Vulnerability;
}

export const SysdigContent = ({ vulnerability }: SysdigContentProps) => {
  const info = vulnerability.scannerSpecificInfo.sysdigInfo;
  if (!info) {
    return <ErrorBanner />;
  }
  const link = new URL(info?.htmlUrl).href;

  return (
    <Typography>
      <strong>CVE-link: </strong>
      <Link to={getCveURL(vulnerability.vulnerabilityId)}>
        {vulnerability.vulnerabilityId}
      </Link>
      <br />
      <strong>Sysdig-link: </strong>
      <Link to={link}>
        {link.length > 80 ? link.slice(0, 30).concat('...') : link}
      </Link>
      <br />
      <strong>Container name: </strong>
      {Array.isArray(info?.containers)
        ? info!.containers.join(', ')
        : info?.containers}
      <br />
      <strong>Cluster: </strong>
      {Array.isArray(info?.clusters)
        ? info!.clusters.join(', ')
        : info?.clusters}
      <br />
      <strong>Namespace: </strong>
      {info.namespace}
      <br />
      <strong>Package names: </strong>
      {info.packages}
      <br />
      <strong>Is exploitable: </strong>
      {info.isExploitable ? 'Yes' : 'No'}
      <br />
      <strong>Is running: </strong>
      {info.isRunning ? 'Yes' : 'No'}
    </Typography>
  );
};
