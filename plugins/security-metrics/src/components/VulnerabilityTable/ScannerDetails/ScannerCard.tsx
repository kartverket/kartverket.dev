import { useTheme } from '@mui/material/styles';
import Typography from '@mui/material/Typography';
import Box from '@mui/system/Box';
import { ReactNode } from 'react';
import { BASIC_COLORS, SCANNER_CARD, SCANNER_COLORS } from '../../../colors';
import { Scanner, Severity } from '../../../typesFrontend';
import { getScannerColor } from '../../utils';

type LabelProps = {
  color: string;
  title: string | Severity;
};

const ScannerLabel = ({ color, title }: LabelProps): ReactNode => {
  let textColor;
  if (color === SCANNER_COLORS.SYSDIG) {
    textColor = BASIC_COLORS.BLACK;
  } else {
    textColor = BASIC_COLORS.WHITE;
  }
  return (
    <Box
      display="flex"
      justifyContent="center"
      sx={{ backgroundColor: color }}
      width="max-content"
      px={0.5}
      borderRadius={1}
      fontWeight={500}
      fontSize={14}
      color={textColor}
    >
      <Typography>
        <strong style={{ fontSize: 14 }}>{title.toUpperCase()}</strong>
      </Typography>
    </Box>
  );
};

type Props = {
  scanner: Scanner;
  children: ReactNode;
};

export const ScannerCard = ({ scanner, children }: Props) => {
  const theme = useTheme();
  const isDarkMode = theme.palette.mode === 'dark';
  return (
    <Box
      display="grid"
      gridAutoRows="max-content"
      gap={1}
      marginLeft={2}
      marginBottom={2}
      borderRadius={1}
      padding={2}
      sx={{
        borderLeft: 8,
        borderColor: getScannerColor(scanner),
        backgroundColor: isDarkMode ? SCANNER_CARD.DARK : SCANNER_CARD.LIGHT,
        maxWidth: 600,
      }}
    >
      <ScannerLabel color={getScannerColor(scanner)} title={scanner} />
      {children}
    </Box>
  );
};
