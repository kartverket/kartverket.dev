import { Vulnerability, Scanner } from '../../typesFrontend';
import Tooltip from '@mui/material/Tooltip';
import BuildIcon from '@mui/icons-material/Build';
import SubdirectoryArrowRightIcon from '@mui/icons-material/SubdirectoryArrowRight';
import GpsFixedIcon from '@mui/icons-material/GpsFixed';
import BugReportIcon from '@mui/icons-material/BugReport';
import PolicyIcon from '@mui/icons-material/Policy';

type Props = {
  vulnerability: Vulnerability;
};

export const VulnerabilityContext = ({ vulnerability }: Props) => {
  const scanners = vulnerability.scanners;
  const dependabot = vulnerability.scannerSpecificInfo.dependabotInfo;
  const sysdig = vulnerability.scannerSpecificInfo.sysdigInfo;

  return (
    <>
      {scanners.includes(Scanner.Dependabot) &&
        (dependabot?.isDirect ? (
          <Tooltip title="Sårbarhet i direkte avhengighet">
            <SubdirectoryArrowRightIcon />
          </Tooltip>
        ) : (
          <Tooltip title="Sårbarhet i transitiv eller ukjent avhengighet">
            <SubdirectoryArrowRightIcon color="disabled" />
          </Tooltip>
        ))}

      {(scanners.includes(Scanner.Dependabot) ||
        scanners.includes(Scanner.Sysdig)) &&
        (sysdig?.isFixable || dependabot?.isFixable ? (
          <Tooltip title="Fiks tilgjengelig">
            <BuildIcon fontSize="small" />
          </Tooltip>
        ) : (
          <Tooltip title="Ingen kjent fiks">
            <BuildIcon fontSize="small" color="disabled" />
          </Tooltip>
        ))}

      {scanners.includes(Scanner.Sysdig) &&
        (sysdig?.isRunning ? (
          <Tooltip title="Sårbar pakke er i bruk">
            <GpsFixedIcon fontSize="small" />
          </Tooltip>
        ) : (
          <Tooltip title="Sårbar pakke kjører ikke">
            <GpsFixedIcon fontSize="small" color="disabled" />
          </Tooltip>
        ))}

      {scanners.includes(Scanner.Sysdig) &&
        (sysdig?.isExploitable ? (
          <Tooltip title="Offentlig exploit finnes">
            <BugReportIcon fontSize="small" />
          </Tooltip>
        ) : (
          <Tooltip title="Ingen kjent offentlig exploit">
            <BugReportIcon fontSize="small" color="disabled" />
          </Tooltip>
        ))}

      {scanners.includes(Scanner.Sysdig) &&
        (sysdig?.isCisaKEV ? (
          <Tooltip title="Sårbarhet er i CISA Known Exploited Vulnerabilities (KEV)">
            <PolicyIcon fontSize="small" />
          </Tooltip>
        ) : (
          <Tooltip title="Sårbarhet er ikke i CISA Known Exploited Vulnerabilities (KEV)">
            <PolicyIcon fontSize="small" color="disabled" />
          </Tooltip>
        ))}
    </>
  );
};
