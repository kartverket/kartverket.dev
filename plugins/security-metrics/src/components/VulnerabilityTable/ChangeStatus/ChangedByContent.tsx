import Box from '@mui/material/Box';
import { formatDate } from 'date-fns';
import { ErrorBanner } from '../../ErrorBanner';
import { useUserInfo } from '../../../hooks/useUserInfo';
import Avatar from '@mui/material/Avatar';

interface ChangedByContentProps {
  changedBy: string;
  changedAt?: Date;
}

export const ChangedByContent = ({
  changedBy,
  changedAt,
}: ChangedByContentProps) => {
  const { user, error } = useUserInfo(changedBy);

  const displayName = user?.spec?.profile?.displayName;
  const avatarSrc = user?.spec?.profile?.picture;

  return error ? (
    <ErrorBanner />
  ) : (
    <Box display="flex" alignItems="center" gap={1}>
      {changedAt && `Sist endret ${formatDate(changedAt, 'dd.MM.yyyy')} av `}
      <Avatar src={avatarSrc} alt={displayName} />
      {displayName}
    </Box>
  );
};
