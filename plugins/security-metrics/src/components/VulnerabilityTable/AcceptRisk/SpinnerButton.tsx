import Button from '@mui/material/Button';
import CircularProgress from '@mui/material/CircularProgress';

type SpinnerButtonProps = {
  spinnerSize?: number;
  loading: boolean;
  disabled?: boolean;
  children: React.ReactNode;
  onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;
} & Omit<React.ComponentProps<typeof Button>, 'disabled' | 'onClick'>;

export const SpinnerButton = ({
  spinnerSize = 18,
  loading,
  disabled,
  children,
  onClick,
  ...buttonProps
}: SpinnerButtonProps) => {
  const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {
    if (loading || disabled) return;
    onClick?.(e);
  };

  return (
    <Button
      variant="contained"
      onClick={handleClick}
      disabled={loading || disabled}
      {...buttonProps}
    >
      {children}
      {loading && (
        <CircularProgress
          size={spinnerSize}
          sx={{ position: 'absolute', inset: 0, m: 'auto' }}
        />
      )}
    </Button>
  );
};
